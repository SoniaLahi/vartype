<html lang="en" onclick="keyPressed()">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Variab</title>
    <link href="stylesheet.css" rel='stylesheet' type='text/css'>
</head>
    <body onload="start()" onkeydown="keyPressed()">

<header class="containerheader" style="display:none;"id="headscore">
    <div class="element">
        <p class="aligncenter"><strong> (c) </strong>to<br> collection </p>
    </div>
    <div class="element">
    <p class="aligncenter"><strong> (s) </strong>to<br> exit</p>
    </div>
</header>

<div class="main" style="display:none"  id="score">
    <div class="containerscore" class="settingssize">
        <div class="elementscore">
            <p class="currant"> Level 0 - <strong>100%</strong></p>
        </div>
        <div class="elementscore" style="display: flex;">
            <div>
                <p>steps</p>
            </div>
            <div>
                <p>precision</p>
            </div>
            <div>
                <p>reactivity</p>
            </div>
            <div>
                <p>score</p>
            </div>
        </div>
        <div class="elementscore" style="display: flex;" id="scoreboard">
            <div>
                <p>01</p>
                <p>02</p>
                <p>03</p>
                <p>04</p>
                <p>05</p>
            </div>
            <div>
                <p>0%</p>
                <p>0%</p>
                <p>0%</p>
                <p>0%</p>
                <p>0%</p>
            </div>
            <div>
                <p>0</p>
                <p>0</p>
                <p>0</p>
                <p>0</p>
                <p>0</p>
            </div>
            <div style="font-weight: 600;">
                <p>0%</p>
                <p>0%</p>
                <p>0%</p>
                <p>0%</p>
                <p>0%</p>
            </div>
        </div>
        <div style="height:5px; border-radius:5px; margin-top: 20px; background-color:black; top:75%; position:relative; -ms-transform: translateY(-50%);transform: translateY(-50%);"></div>
        <div class="elementscore" style="text-align: center;margin-top:20px;display: flex; justify-content: space-evenly;">
            <p>Press <strong>(erase)</strong><br> to try again</p>
            <p>Press <strong>(spacebar)</strong><br> to start the<br> next level</p>
        </div>
    </div>
</div>





         <div class="main" id="game">
			<div style="width: 70%; margin:0 auto;">
			<div style="height: 25vw; position: relative;">
				<p class="affiche">0</p>
				<p class="text" style="font-variation-settings:'wght' 100; font-family:'GT-Alpina-VAR-Trial';">x-height1</p>
				<p class="text" style="font-variation-settings:'wght' 400;">x-height2</p>
				<p class="text" style="font-variation-settings:'wght' 800;">x-height3</p>
				<p class="text" style="font-variation-settings:'wght' 400;">x-height4</p>
			</div>
		    <div style="height:20px; width:70%; margin:0 auto;">
			    <div style="height:5px; border-radius:5px; background-color:black; margin:auto; top:75%; position:relative; -ms-transform: translateY(-50%);transform: translateY(-50%);"></div>
			    <div class="slider"></div>
		    </div>
            <p class="currant" id="spacebar">Hit <strong>(spacebar)</strong><br>to validate</p>
			<p class="r" style="position:absolute; top:0; left:0;">0,0</p>
		</div>
		</div>
		
		<script>
		var k=false;
		var id = setInterval(loop, 10);
		var t=0,sldr,r,lvl=0,step=0,score=[],penalty=[],press=-1000,prm=50,str,mode=0,fontvar;
		var font=["font1",'"GT-Alpina-VAR-Trial"',"font2","font3"];
		var fmin=[];
		var fmax=[];
		var fout;
		function loop() {
			switch(mode) {
				case 0:
					//Load Ready?
					document.getElementsByClassName("affiche")[0].innerHTML="Ready?";
					document.getElementsByClassName("affiche")[0].style.opacity=1;
					document.getElementsByClassName("slider")[0].style.opacity=1;
					document.getElementById("spacebar").innerHTML="Press <strong>(spacebar)</strong><br>to start";
					document.getElementById("spacebar").style.opacity=1;
					mode=1;
					break;
				case 1:
					//Wait Input
					ready();
					break;
				case 2:
					//Play Game 0
					if(step==2) {
						lvl++;
						step=0;
						mode++;
						k=false;
					} else {
						level(false,2);
					}
					break;
				case 3:
					//Load Scoreboard
					scoreboard();
					mode++;
					k=false;
					break;
				case 4:
					//Wait
					waitscore();
					break;
			}
			function ready() {
				t++;
				sldr=-Math.cos(t/100*Math.PI)*50+50;
				document.getElementsByClassName("slider")[0].style.marginLeft=sldr+"%";
				if(k==true) {
					mode=2;
					t=-200;
					document.getElementsByClassName("affiche")[0].style.opacity=0;
					document.getElementsByClassName("slider")[0].style.opacity=0;
					document.getElementById("spacebar").innerHTML="Hit <strong>(spacebar)</strong><br>to validate";
					document.getElementById("spacebar").style.opacity=0;
				}
			}
			function level(wait,flash) {
				if(flash<2) {
					if(t==-200) {
						//Get Font settings 
						document.getElementsByClassName("affiche")[0].style.fontFamily=document.getElementsByClassName("text")[step].style.fontFamily;
						document.getElementsByClassName("affiche")[0].style.fontVariationSettings=document.getElementsByClassName("text")[step].style.fontVariationSettings;
						document.getElementsByClassName("affiche")[0].innerHTML=document.getElementsByClassName("text")[step].innerHTML;
						
						fontvar=document.getElementsByClassName("text")[step].style.fontVariationSettings.split(" ")
						prm= (fontvar[1]-100)/6;
						//fout=search(document.getElementsByClassName("text")[step].style.fontFamily);
						fontvar=fontvar[0];
						t=0;
						document.getElementsByClassName("affiche")[0].style.opacity=1;
						k=false;
						document.getElementById("spacebar").style.opacity=1;
						document.getElementById("spacebar").innerHTML="Press <strong>(spacebar)</strong><br>to continue";
					}	
					if(flash==0 && t==0) {
						document.getElementsByClassName("text")[step].style.display="block";
						k=true;
					}
					if(t==0 && k) { 
						t++;
						k=false;
						//Start Game
						document.getElementsByClassName("affiche")[0].style.opacity=1;
						document.getElementsByClassName("slider")[0].style.marginLeft=0+"%";
						document.getElementsByClassName("slider")[0].style.opacity=1;
						document.getElementById("spacebar").innerHTML="Hit <strong>(spacebar)</strong><br>to validate";
					}
					if(t>0) {
						t++;
					}
				}
				if(flash==2) {
					t++;
					switch(t) {
						//t=-200;
						case -120:
							//Get Font settings 
							document.getElementsByClassName("affiche")[0].style.fontFamily=document.getElementsByClassName("text")[step].style.fontFamily;
							document.getElementsByClassName("affiche")[0].style.fontVariationSettings=document.getElementsByClassName("text")[step].style.fontVariationSettings;
							document.getElementsByClassName("affiche")[0].innerHTML=document.getElementsByClassName("text")[step].innerHTML;
							
							fontvar=document.getElementsByClassName("text")[step].style.fontVariationSettings.split(" ")
							prm= (fontvar[1]-100)/6;
							fout=search(document.getElementsByClassName("text")[step].style.fontFamily);
							fontvar=fontvar[0];
							
							//Flash On
							document.getElementsByClassName("affiche")[0].style.opacity=1;
							break;
						case -80:
							//Flash Off
							document.getElementsByClassName("affiche")[0].style.opacity=0;
							break;
						case 0:
							//Start Game
							document.getElementsByClassName("affiche")[0].style.opacity=1;
							document.getElementsByClassName("slider")[0].style.marginLeft=0+"%";
							document.getElementsByClassName("slider")[0].style.opacity=1;
							document.getElementById("spacebar").style.opacity=1;
							document.getElementById("spacebar").innerHTML="Hit <strong>(spacebar)</strong><br>to validate";
							k=false;
					}
				}
				
				if(0<t) {
					if(wait) {
						if(k && press==-1000){
							//Wait Player Input
							//Save Score/Input Time
							press=t;
							score.push(Math.ceil(100-Math.abs(sldr-prm)));
							penalty.push(r)
							document.getElementsByClassName("text")[step].style.display="block";
							document.getElementById("spacebar").innerHTML="Press <strong>(spacebar)</strong><br>to continue";
							k=false;
						} else if(k) {
							//Reset & Advance Game
							document.getElementsByClassName("slider")[0].style.opacity=0;
							document.getElementsByClassName("affiche")[0].style.opacity=0;
							document.getElementById("spacebar").style.opacity=0;
							document.getElementsByClassName("text")[step].style.display="none";
							step++;
							press=-1000;
							t=-200;
						} else if(press==-1000) {
							//Move Game
							r=Math.floor(t/100)+1;
							sldr=-Math.cos(t/100*Math.PI)*50+50;
							document.getElementsByClassName("affiche")[0].style.fontVariationSettings="'wght'"+(sldr*6+100);
							document.getElementsByClassName("slider")[0].style.marginLeft=sldr+"%";
						}
					} else {
						if(press==-1000) {
							//Move Game
							r=Math.floor(t/100)+1;
							sldr=-Math.cos(t/100*Math.PI)*50+50;
							document.getElementsByClassName("affiche")[0].style.fontVariationSettings="'wght'"+(sldr*6+100);
							document.getElementsByClassName("slider")[0].style.marginLeft=sldr+"%";
							if(k) {
								//Save Score/Input Time
								press=t;
								score.push(Math.ceil(100-Math.abs(sldr-prm)));
								penalty.push(r)
								document.getElementsByClassName("slider")[0].style.opacity=0;
								document.getElementsByClassName("text")[step].style.display="block";
								k=false;
							
							}
						}
						if(press==t-100 && wait==false) {
							//Reset & Advance Game
							document.getElementsByClassName("affiche")[0].style.opacity=0;
							document.getElementById("spacebar").style.opacity=0;
							document.getElementsByClassName("text")[step].style.display="none";
							step++;
							press=-1000;
							if(flash==2) {
								t=-200;
							}
							if(flash<2) {
								t=-1;
							}
						}
					}
				}
				function search(fnt) {
					for(var i=0;i<font.length;i++) {
						if(fnt==font[i]) {
							return i
						}
					}
				}
			}
			function scoreboard() {
				document.getElementById("headscore").style.display="flex";
				document.getElementById("score").style.display="block";
				document.getElementById("game").style.filter= "blur(8px)";
				document.getElementsByClassName("r")[0].innerHTML=score;
				for(var i=0;i<score.length;i++) {
					document.getElementById("scoreboard").children[1].children[i].innerHTML=score[i]+"%";
					document.getElementById("scoreboard").children[2].children[i].innerHTML=penalty[i]-1;
					document.getElementById("scoreboard").children[3].children[i].innerHTML=Math.ceil(score[i]/penalty[i])+"%";
				}
			}
			function waitscore() {
				if(k) {
					document.getElementById("headscore").style.display="none";
					document.getElementById("score").style.display="none";
					document.getElementById("game").style.filter= "none";
					mode=0;
					score=[];
					penalty=[];
					k=false;
				}
			}
		}		
		function keyPressed() {
			if(event.key=="Escape") {
				clearInterval(id);
			}
			k=true;
		}
		</script>
	</body>
</html>
