<html lang="en" onclick="keyPressed()">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Variab</title>
    <link href="stylesheet.css" rel='stylesheet' type='text/css'>
</head>
    <body onload="start()" onkeydown="keyPressed()">
        <header>

        </header>
        <div>
			<div>
				<p class="affiche"></p>
				<p class="text" style="font-variation-settings:'wght' 100;">x-height1</p>
				<p class="text" style="font-variation-settings:'wght' 400;">x-height2</p>
				<p class="text" style="font-variation-settings:'wght' 800;">x-height3</p>
				<p class="text" style="font-variation-settings:'wght' 400;">x-height4</p>
			</div>
		    <div style="height:20px; width:70%; margin:0 auto;">
			    <div style="height:5px; border-radius:5px; background-color:black; margin:auto; top:75%; position:relative; -ms-transform: translateY(-50%);transform: translateY(-50%);"></div>
			    <div class="slider"></div>
		    </div>
            <p class="currant">Hit <strong>(spacebar)</strong><br>to validate</p>
			<p class="r" style="position:absolute; top:0; left:0;">0,0</p>
			<p class="r" style="position:absolute; top:0; right:0;">score</p>	
        </div>
		
		<script>
		var k=true;
		var id = setInterval(loop, 10);
		var t=-200,sldr=0,r=1,lvl=0,step=3,score=[],press=-1,prm=50,str,mode=1;
		function loop() {
			document.getElementsByClassName("r")[0].innerHTML=r;
			switch(mode) {
				case 0:
					ready()
				case 1:
					level();
					break;
					
			}
			function ready() {
				
			}
			function level() {
				//t=-200;
				t++;
				switch(t) {
					case -199:
						document.getElementsByClassName("affiche")[0].fontFamily=document.getElementsByClassName("text")[step].style.fontFamily;
						document.getElementsByClassName("affiche")[0].style.fontVariationSettings=document.getElementsByClassName("text")[step].style.fontVariationSettings;
						document.getElementsByClassName("affiche")[0].innerHTML=document.getElementsByClassName("text")[step].innerHTML;
					case -120:
						//Flash On
						document.getElementsByClassName("affiche")[0].style.opacity=1;
						prm= (document.getElementsByClassName("text")[step].style.fontVariationSettings.split(" ")[1]-100)/6;
						break;
					case -80:
						//Flash Off
						document.getElementsByClassName("affiche")[0].style.opacity=0;
						break;
					case 0:
						document.getElementsByClassName("affiche")[0].style.opacity=1;
						document.getElementsByClassName("slider")[0].style.marginLeft=0+"%";
						document.getElementsByClassName("slider")[0].style.opacity=1;
						document.getElementsByClassName("currant")[0].style.opacity=1;
						k=false
				}
				
				if(0<t) {
					if(k) {
						if(press==-1) {
							press=t;
							score.push(Math.floor((100-Math.abs(sldr-prm))/r));
							document.getElementsByClassName("slider")[0].style.opacity=0;
							document.getElementsByClassName("currant")[0].style.opacity=0;
							document.getElementsByClassName("text")[step].style.display="block";

							document.getElementsByClassName("r")[1].innerHTML=score;
						}
						if(press<t-100) {
							document.getElementsByClassName("affiche")[0].style.opacity=0;
							document.getElementsByClassName("text")[step].style.display="none";
							step++;
							if(step==4) {
								lvl++;
								step=0
							}
							press=-1;
							t=-200;
						}

					} else {
						r=Math.floor(t/100)+1;
						sldr=-Math.cos(t/100*Math.PI)*50+50;
						document.getElementsByClassName("affiche")[0].style.fontVariationSettings="'wght'"+sldr*6+100;
						document.getElementsByClassName("slider")[0].style.marginLeft=sldr+"%";
					}
				}
				document.getElementsByClassName("r")[0].innerHTML=r+", "+step+", "+press+", "+t;
			}	
		}		
		function keyPressed() {
			if(event.key=="Escape") {
				clearInterval(id);
			}
			k=true;
		}
		</script>
	</body>
</html>
